{"version":3,"file":"odo-expandable.js","sources":["../src/expandable-settings.js","../src/expandable-group.js","../src/expandable.js"],"sourcesContent":["export default {\n  ClassName: {\n    TRIGGER_OPEN: 'expandable__trigger--open',\n    TARGET_OPEN: 'expandable__target--open',\n  },\n  Attribute: {\n    TRIGGER: 'data-expandable-trigger',\n    TARGET: 'data-expandable-target',\n    GROUP: 'data-expandable-group',\n  },\n  Defaults: {\n    groupedItem: false,\n  },\n};\n","/**\n * @fileoverview A wrapper for multiple Expandable elements that will\n * allow them to operate coherently in an accordion type fashion.\n *\n * @author Matt Zaso\n */\nimport Settings from './expandable-settings';\nimport Expandable from './expandable';\n\nclass ExpandableGroup {\n  constructor(elements) {\n    /** @type {Array.<!Element>} */\n    this._elements = elements;\n\n    /** @type {Array.<!Expandable>} */\n    this._expandables = elements.map((trigger) => {\n      // Create new expandable instances and keep them in an array.\n      const options = { groupedItem: true };\n      return new Expandable(trigger.getAttribute(Settings.Attribute.TRIGGER), options);\n    });\n\n    this._bindListeners();\n  }\n\n  /**\n   * Binds the listeners to the body to handle click events.\n   * @private\n   */\n  _bindListeners() {\n    this._onClick = this._onClickHandler.bind(this);\n    document.body.addEventListener('click', this._onClick);\n  }\n\n  /**\n   * Handler for clicks on the trigger.\n   * @param {Event} evt Event object.\n   * @private\n   */\n  _onClickHandler(evt) {\n    evt.preventDefault();\n    const closest = evt.target.closest(`[${Settings.Attribute.TRIGGER}]`);\n\n    if (closest !== null && this._elements.includes(closest)) {\n      this._toggleGroupVisibility(closest.getAttribute(Settings.Attribute.TRIGGER));\n    }\n  }\n\n  /**\n   * Will iterate over all grouped items and toggle the selected one while collapsing all others.\n   * @param {int} selectedId The ID of the selected target to expand.\n   * @private\n   */\n  _toggleGroupVisibility(selectedId) {\n    this._expandables.forEach((expandable) => {\n      if (expandable.id === selectedId) {\n        expandable.toggle();\n      } else {\n        expandable.close();\n      }\n    });\n  }\n\n  /**\n   * Dispose this instance and its handlers. Will also dispose all child\n   * instances.\n   * @public\n   */\n  dispose() {\n    document.body.removeEventListener('click', this._onTriggerClick);\n    this._expandables.forEach(item => item.dispose());\n  }\n}\n\nexport default ExpandableGroup;\n","/**\n * @fileoverview An basic, expandable component that has both a trigger\n * and a target to open.\n *\n * @author Matt Zaso\n */\nimport Settings from './expandable-settings';\nimport ExpandableGroup from './expandable-group';\n\nclass Expandable {\n  constructor(id, options = {}) {\n    /** @type {string} */\n    this.id = id;\n\n    /**\n     * Override any defaults with the given options.\n     * @type {Object}\n     */\n    this.options = Object.assign({}, Settings.Defaults, options);\n\n    /** @type {Element} */\n    this._trigger = document.body.querySelector(`[${Settings.Attribute.TRIGGER}=\"${id}\"]`);\n\n    /** @type {Element} */\n    this._target = document.body.querySelector(`[${Settings.Attribute.TARGET}=\"${id}\"]`);\n\n    this._setARIAAttributes();\n\n    this._bindListeners();\n  }\n\n  /**\n   * Binds the listeners to the body to handle click events.\n   * @private\n   */\n  _bindListeners() {\n    if (!this.options.groupedItem) {\n      this._onTriggerClick = this._triggerClickHandler.bind(this);\n      document.body.addEventListener('click', this._onTriggerClick);\n    }\n  }\n\n  /**\n   * Handler for clicks on the trigger.\n   * @param {Event} evt Event object.\n   * @private\n   */\n  _triggerClickHandler(evt) {\n    evt.preventDefault();\n    const closest = evt.target.closest(`[${Settings.Attribute.TRIGGER}]`);\n\n    if (closest !== null && closest === this._trigger) {\n      this.toggle();\n    }\n  }\n\n  /**\n   * Sets the appropriate ARIA attributes for a11y.\n   * @private\n   */\n  _setARIAAttributes() {\n    const elementId = `expandable-${this.id}`;\n\n    this._trigger.setAttribute('aria-describedby', elementId);\n\n    this._target.setAttribute('id', elementId);\n    this._target.setAttribute('role', 'region');\n    this._target.setAttribute('aria-expanded', 'true');\n  }\n\n  /**\n   * Removes the ARIA attributes assigned on instantiation.\n   * @private\n   */\n  _removeARIAAttributes() {\n    this._trigger.removeAttribute('aria-describedby');\n    this._target.removeAttribute('id');\n    this._target.removeAttribute('role');\n    this._target.removeAttribute('aria-expanded');\n  }\n\n  /**\n   * Toggles the expandable's state (open/closed).\n   */\n  toggle() {\n    if (this.isOpen) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n\n  /**\n   * Opens the expandable.\n   */\n  open() {\n    this._target.classList.add(Settings.ClassName.TARGET_OPEN);\n    this._trigger.classList.add(Settings.ClassName.TRIGGER_OPEN);\n    this._target.setAttribute('aria-expanded', 'true');\n  }\n\n  /**\n   * Closes the expandable.\n   */\n  close() {\n    this._target.classList.remove(Settings.ClassName.TARGET_OPEN);\n    this._trigger.classList.remove(Settings.ClassName.TRIGGER_OPEN);\n    this._target.setAttribute('aria-expanded', 'false');\n  }\n\n  get isOpen() {\n    return this._target.classList.contains(Settings.ClassName.TARGET_OPEN);\n  }\n\n  /**\n   * Dispose this instance and its handlers.\n   */\n  dispose() {\n    if (!this.options.groupedItem) {\n      document.body.removeEventListener('click', this._onTriggerClick);\n    }\n\n    this._removeARIAAttributes();\n  }\n\n  /**\n   * Instantiates all instances of the expandable. Groups are instantiated separate from\n   * Expandables and require different parameters. This helper chunks out and groups the\n   * grouped expandables before instantiating all of them.\n   *\n   * @return {Array.<Expandable, ExpandableGroup>} all instances of both types.\n   * @public\n   */\n  static initializeAll() {\n    const elements = Array.from(document.querySelectorAll(`[${Settings.Attribute.TRIGGER}]`));\n\n    const single = [];\n    const groups = [];\n    const groupIds = [];\n\n    elements.forEach((item) => {\n      if (item.getAttribute(Settings.Attribute.GROUP)) {\n        const groupId = item.getAttribute(Settings.Attribute.GROUP);\n        if (groupIds.indexOf(groupId) < 0) {\n          groups.push(elements.filter(el => el.getAttribute(Settings.Attribute.GROUP) === groupId));\n          groupIds.push(groupId);\n        }\n      } else {\n        single.push(item);\n      }\n    });\n\n    const singleInstances =\n      single.map(trigger => new Expandable(trigger.getAttribute(Settings.Attribute.TRIGGER)));\n    const groupInstances = groups.map(grouping => new ExpandableGroup(grouping));\n\n    return singleInstances.concat(groupInstances);\n  }\n}\n\nObject.assign(Expandable, Settings);\n\nexport default Expandable;\n"],"names":["ExpandableGroup","elements","_elements","_expandables","map","trigger","options","groupedItem","Expandable","getAttribute","Settings","Attribute","TRIGGER","_bindListeners","_onClick","_onClickHandler","bind","body","addEventListener","evt","preventDefault","closest","target","includes","_toggleGroupVisibility","selectedId","forEach","expandable","id","toggle","close","dispose","removeEventListener","_onTriggerClick","item","Object","assign","Defaults","_trigger","document","querySelector","_target","TARGET","_setARIAAttributes","_triggerClickHandler","elementId","setAttribute","_removeARIAAttributes","removeAttribute","isOpen","open","classList","add","ClassName","TARGET_OPEN","TRIGGER_OPEN","remove","initializeAll","Array","from","querySelectorAll","single","groups","groupIds","GROUP","groupId","indexOf","push","filter","el","singleInstances","groupInstances","grouping","concat","contains"],"mappings":"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"}