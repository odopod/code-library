!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@odopod/odo-helpers"),require("@odopod/odo-window-events")):"function"==typeof define&&define.amd?define(["exports","@odopod/odo-helpers","@odopod/odo-window-events"],e):e(t.OdoExpandable={},t.OdoHelpers,t.OdoWindowEvents)}(this,function(t,e,i){"use strict";i=i&&i.hasOwnProperty("default")?i.default:i;var r={ClassName:{TRIGGER_OPEN:"odo-expandable__trigger--open",TARGET_OPEN:"odo-expandable__target--open"},Attribute:{TRIGGER:"data-expandable-trigger",TARGET:"data-expandable-target",GROUP:"data-expandable-group",ANIMATED:"data-expandable-animated"},Defaults:{groupedItem:!1}},n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},a=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,t),this.id=e,this.options=Object.assign({},r.Defaults,i),this.trigger=document.body.querySelector("["+r.Attribute.TRIGGER+'="'+e+'"]'),this.target=document.body.querySelector("["+r.Attribute.TARGET+'="'+e+'"]'),this._setA11yAttributes(),this.options.groupedItem||(this._onTriggerClick=this._triggerClickHandler.bind(this),document.body.addEventListener("click",this._onTriggerClick))}return t.prototype._triggerClickHandler=function(t){t.preventDefault(),t.target.closest("["+r.Attribute.TRIGGER+"]")===this.trigger&&this.toggle()},t.prototype._setA11yAttributes=function(){var t="expandable-"+this.id;this.trigger.setAttribute("aria-describedby",t),this.target.setAttribute("id",t),this.trigger.setAttribute("aria-expanded",this.isOpen.toString()),this.trigger.setAttribute("aria-controls",t),this.target.setAttribute("aria-labelledby",t),this.target.setAttribute("aria-hidden",(!this.isOpen).toString())},t.prototype._removeA11yAttributes=function(){this.trigger.removeAttribute("aria-describedby"),this.target.removeAttribute("id"),this.trigger.removeAttribute("aria-expanded"),this.target.removeAttribute("aria-labelledby"),this.target.removeAttribute("aria-hidden")},t.prototype.toggle=function(){this.isOpen?this.close():this.open()},t.prototype.open=function(){this.target.classList.add(r.ClassName.TARGET_OPEN),this.trigger.classList.add(r.ClassName.TRIGGER_OPEN),this.trigger.setAttribute("aria-expanded","true"),this.target.setAttribute("aria-hidden","false")},t.prototype.close=function(){this.target.classList.remove(r.ClassName.TARGET_OPEN),this.trigger.classList.remove(r.ClassName.TRIGGER_OPEN),this.trigger.setAttribute("aria-expanded","false"),this.target.setAttribute("aria-hidden","true")},t.prototype.dispose=function(){this.options.groupedItem||document.body.removeEventListener("click",this._onTriggerClick),this._removeA11yAttributes()},o(t,[{key:"isOpen",get:function(){return this.target.classList.contains(r.ClassName.TARGET_OPEN)}}]),t}();Object.assign(a,r);var u=function(){function t(e){n(this,t),this._elements=e,this.expandables=e.map(function(t){return new a(t.getAttribute(r.Attribute.TRIGGER),{groupedItem:!0})}),this._onClick=this._onClickHandler.bind(this),document.body.addEventListener("click",this._onClick)}return t.prototype._onClickHandler=function(t){t.preventDefault();var e=t.target.closest("["+r.Attribute.TRIGGER+"]");this._elements.includes(e)&&this.toggleVisibility(e.getAttribute(r.Attribute.TRIGGER))},t.prototype.toggleVisibility=function(t){this.expandables.forEach(function(e){e.id===t?e.toggle():e.close()})},t.prototype.dispose=function(){document.body.removeEventListener("click",this._onTriggerClick),this.expandables.forEach(function(t){return t.dispose()})},t}();Object.assign(u,r);var d=function(t){function r(e){n(this,r);var o=s(this,t.call(this,e));return o._expandableOffsets=null,o._saveOffsets(),o.expandables.forEach(function(t){return o._setHeight(t,t.isOpen)}),o._resizeId=i.onResize(o._handleResize.bind(o)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,t),r.prototype._handleResize=function(){var t=this;this._saveOffsets(),this.expandables.forEach(function(e){return t._setHeight(e,e.isOpen)})},r.prototype.toggleVisibility=function(e){var i=this;this._scrollToSelected(e),this.expandables.forEach(function(t){return i._animateHeight(t,t.id===e)}),t.prototype.toggleVisibility.call(this,e)},r.prototype._saveOffsets=function(){var t=window.pageYOffset+this.expandables[0].trigger.getBoundingClientRect().top;this._expandableOffsets=this.expandables.map(function(e,i){var r=t+i*e.target.firstElementChild.offsetHeight;return{id:e.id,offset:r}})},r.prototype._scrollToSelected=function(t){var i=window.pageYOffset,r=i+window.innerHeight,n=this._expandableOffsets.find(function(e){return e.id===t}).offset;(n<i||n>r)&&e.scrollTo(n,300)},r.prototype._setHeight=function(t,e){var i=e?t.target.firstElementChild.offsetHeight:0;t.target.style.height=i+"px"},r.prototype._animateHeight=function(t,e){(e||t.isOpen)&&this._setHeight(t,!t.isOpen)},r.prototype.dispose=function(){t.prototype.dispose.call(this),i.remove(this._resizeId)},r}(u);t.initializeAll=function(){var t=Array.from(document.querySelectorAll("["+r.Attribute.TRIGGER+"]")),e=[],i=[],n=[];t.forEach(function(o){var s=o.getAttribute(r.Attribute.GROUP);s?n.includes(s)||(i.push(t.filter(function(t){return t.getAttribute(r.Attribute.GROUP)===s})),n.push(s)):e.push(o)});var o=e.map(function(t){return new a(t.getAttribute(r.Attribute.TRIGGER))}),s=i.map(function(t){return t.some(function(t){return t.hasAttribute(r.Attribute.ANIMATED)})?new d(t):new u(t)});return o.concat(s)},t.Settings=r,t.ExpandableItem=a,t.ExpandableGroup=u,t.ExpandableAccordion=d,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=odo-expandable.min.js.map
